---
layout: post
title: "List of FDA-approved drugs and CNS drugs with SMILES"
author: ericminikel
date: 2013-10-04 07:24:26
---
<p><strong>short story</strong></p>
<p>Here is <a href="/wp-content/uploads/2013/10/drugs.txt">a table listing FDA-approved drugs</a> (1691) and 3 columns:</p>
<ol>
<li><code>generic_name</code>: Generic name from <a href="http://www.drugbank.ca/">DrugBank</a></li>
<li><code>cns_drug</code>: TRUE/FALSE, based on whether any of 5 insurance plans I checked had the drug listed under &#8220;Central Nervous System agents&#8221; or similar</li>
<li><code>smiles</code>: isomeric <a href="http://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system">SMILES</a> from <a href="http://www.drugbank.ca/">DrugBank</a>.  When this field is empty it&#8217;s usually because the drug is a large biomolecule.</li>
</ol>
<p>Alternately here is <a href="/wp-content/uploads/2013/10/cnsdrugs.txt">just a straight list of FDA-approved CNS drugs</a> (221).</p>
<p>These lists are current as of October 4, 2013 but cannot be guaranteed accurate or exhaustive; use at your own risk.  For details on how and why I created these, read on.</p>
<p><strong>motivation</strong></p>
<p>Following up on <a title="A quick intro to chemical informatics in R" href="/2013/09/23/a-quick-intro-to-chemical-informatics-in-r/">my recent foray into cheminformatics</a>, I thought it would be nice to have simple list of FDA-approved drugs.  This would be nice for plotting the physicochemical properties of molecules of interest to see how they overlap with the space of drugs, while also being able to spot-check any individual drug and ask &#8220;what <em>is </em>that?&#8221;.  Since I&#8217;m interested in the central nervous system, it would be especially nice to have drugs flagged with a TRUE/FALSE as to whether they&#8217;re CNS drugs, since the need for blood-brain barrier permeability limits these to a much smaller chemical space.</p>
<p>Any other chemical properties I need later I can always get from the SMILES using <a href="http://cran.r-project.org/web/packages/rcdk/rcdk.pdf">rcdk</a>.</p>
<p><strong>first try</strong></p>
<p>Surely some simple list like this already exists on the internet, but it&#8217;s been surprisingly difficult to find.</p>
<p>When I Googled &#8220;list of FDA-approved drugs&#8221; at first I only found hits like <a href="http://www.accessdata.fda.gov/scripts/cder/drugsatfda/">Drugs@FDA</a> (searchable but not downloadable and no chemical information), <a href="http://www.fda.gov/drugs/informationondrugs/ucm142438.htm">FDA&#8217;s NDC directory</a> (downloadable database with regulatory info and common names but no chemical info; also it lists substances such as &#8220;WATER&#8221;), <a href="http://www.medilexicon.com/drugsearch.php?z=true">Medilexicon&#8217;s Drug Search</a> (no chemical data and all human-readable HTML, no machine-readable data).  <a href="http://zinc.docking.org/">ZINC</a>, meanwhile, has lists of FDA-approved drugs with SMILES and chemical data from the <a href="http://zinc.docking.org/catalogs/msusdrugs">MSDI US Drugs Collection</a> and the <a href="http://zinc.docking.org/catalogs/fda">EPA&#8217;s DSSTOX toxicology study of FDA-approved drugs</a>.  But these, conversely, don&#8217;t have common names.</p>
<p>Finally I looked at the <a href="http://www.epa.gov/ncct/dsstox/sdf_fdamdd.html">EPA&#8217;s own DSSTOX webpage</a> and downloaded <a href="http://www.epa.gov/ncct/dsstox/StructureDataFiles/FDAMDD_DownloadFiles/FDAMDD_v3b_1216_15Feb2008.zip">this file</a>.  Finally: this file has both SMILES <em>and</em> common names.  But I was a bit disturbed that it doesn&#8217;t seem to match the data from the same EPA study <a href="http://zinc.docking.org/catalogs/fda">as housed at ZINC</a>:</p>
<div class="highlight" style="background: #f8f8f8;">
<pre style="line-height: 125%;">options(stringsAsFactors<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>)

<span style="color: #408080; font-style: italic;"># from http://zinc.docking.org/catalogs/fda</span>
zinc_fda_prop <span style="color: #666666;">=</span> read.table(<span style="color: #ba2121;">'c:/sci/037cinf/data/EPA-DSSTOX/fda_prop.xls'</span>,header<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">TRUE</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">'\t'</span>,quote<span style="color: #666666;">=</span><span style="color: #ba2121;">""</span>,comment.char<span style="color: #666666;">=</span><span style="color: #ba2121;">""</span>)
<span style="color: #408080; font-style: italic;"># unzipped from http://www.epa.gov/ncct/dsstox/StructureDataFiles/FDAMDD_DownloadFiles/FDAMDD_v3b_1216_15Feb2008.zip and exported to plain text</span>
fda_annotations <span style="color: #666666;">=</span> read.table(<span style="color: #ba2121;">'c:/sci/037cinf/data/EPA-DSSTOX/FDAMDD_v3b_1216_15Feb2008_nostructures.txt'</span>,header<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">TRUE</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">'\t'</span>,quote<span style="color: #666666;">=</span><span style="color: #ba2121;">""</span>,comment.char<span style="color: #666666;">=</span><span style="color: #ba2121;">""</span>)

dim(fda_annotations) <span style="color: #408080; font-style: italic;"># 1216 34</span>
dim(zinc_fda_prop) <span style="color: #408080; font-style: italic;"># 3180 14</span>

<span style="color: #408080; font-style: italic;"># can we join on SMILES?</span>
sum(fda_annotations$STRUCTURE_SMILES <span style="color: #666666;">%in%</span> zinc_fda_prop$SMILES) <span style="color: #408080; font-style: italic;"># 2</span>
sum(fda_annotations$STRUCTURE_Parent_SMILES <span style="color: #666666;">%in%</span> zinc_fda_prop$SMILES) <span style="color: #408080; font-style: italic;"># 4</span>
<span style="color: #408080; font-style: italic;"># not a case issue:</span>
sum(toupper(fda_annotations$STRUCTURE_Parent_SMILES) <span style="color: #666666;">%in%</span> toupper(zinc_fda_prop$SMILES)) <span style="color: #408080; font-style: italic;"># 4</span>

<span style="color: #408080; font-style: italic;"># can we join on molecular weight?</span>
sum(fda_annotations$STRUCTURE_MolecularWeight <span style="color: #666666;">%in%</span> zinc_fda_prop$MWT) <span style="color: #408080; font-style: italic;">#2</span>
<span style="color: #408080; font-style: italic;"># ZINC rounds to 3 decimal places, EPA to only 4. </span>
sum(round(fda_annotations$STRUCTURE_MolecularWeight,<span style="color: #666666;">3</span>) <span style="color: #666666;">%in%</span> 
      round(zinc_fda_prop$MWT,<span style="color: #666666;">3</span>)) <span style="color: #408080; font-style: italic;"># 24 matches when rounded to 3 decimal places</span>
sum(round(fda_annotations$STRUCTURE_MolecularWeight,<span style="color: #666666;">2</span>) <span style="color: #666666;">%in%</span> 
      round(zinc_fda_prop$MWT,<span style="color: #666666;">2</span>)) <span style="color: #408080; font-style: italic;"># 302 matches when rounded to 2 decimal places</span>
sum(round(fda_annotations$STRUCTURE_MolecularWeight,<span style="color: #666666;">1</span>) <span style="color: #666666;">%in%</span> 
      round(zinc_fda_prop$MWT,<span style="color: #666666;">1</span>)) <span style="color: #408080; font-style: italic;"># 768 matches when rounded to 1 decimal place</span>

<span style="color: #408080; font-style: italic;"># but rounding to 1 decimal place means the match is no longer unique b/c 860 &lt; 1216</span>
length(unique(round(fda_annotations$STRUCTURE_MolecularWeight,<span style="color: #666666;">1</span>))) <span style="color: #408080; font-style: italic;"># 860</span></pre>
</div>
<p>The two datasets are of different length (1216 vs. 3180 molecules).  Almost none of the SMILES match exactly.  I casted around for a different field to join on, but the only other attribute shared between the two tables was molecular weight.  This gave very few matches, which might be a rounding issue but as I rounded to fewer and fewer decimal places I lost the one-to-one match before I got complete matching.</p>
<p>I spot-checked the first couple items in the list I downloaded from EPA, <a href="http://en.wikipedia.org/wiki/Acemetacin">Acemetacin</a> and <a href="http://en.wikipedia.org/wiki/Acenocoumarol">Acenocoumarol</a>, and the molecular weights listed on Wikipedia indeed matched what&#8217;s in the EPA&#8217;s table.  Acenocoumarol&#8217;s molecular weight is 353.326, so I sorted the ZINC version of the table to find it, and there appeared to be two copies of it, ZINC00538563 and ZINC00538577, neither of which turned up in ZINC&#8217;s own search bar, and Googling them wasn&#8217;t helpful.  Maybe the duplicate entries are the reason ZINC had so many more rows than the EPA&#8217;s version.</p>
<p>So I decided to start from the EPA&#8217;s version of the table.  Since this contained common names, I figured that was a good place to start casting around for a list of CNS drug. The EPA table does have a TherapeuticCategory field, but there are 319 distinct values &#8211; too many to go through and manually pick out which ones are CNS-related.  So when I Googled &#8220;list of CNS drugs&#8221; the most helpful thing I found was <a href="https://www.unitedhealthcareonline.com/ccmcontent/ProviderII/UHC/en-US/Assets/ProviderStaticFiles/ProviderStaticFilesPdf/Tools%20and%20Resources/Pharmacy%20Resources/PDL_Phys_Bk.pdf">a PDF of drugs covered under United Health Care insurance</a>, with CNS drugs listed on pp 13-19.  This seemed like a good place to start.  I copied and pasted the text on pp 13-19 into a text file, read it into R, collapsed it to a single string and then grepped against it:</p>
<div class="highlight" style="background: #f8f8f8;">
<pre style="line-height: 125%;"><span style="color: #408080; font-style: italic;"># https://www.unitedhealthcareonline.com/ccmcontent/ProviderII/UHC/en-US/Assets/ProviderStaticFiles/ProviderStaticFilesPdf/Tools%20and%20Resources/Pharmacy%20Resources/PDL_Phys_Bk.pdf</span>
uhc_cns_drug_list <span style="color: #666666;">=</span> read.table(<span style="color: #ba2121;">'c:/sci/037cinf/data/uhc-cns-drugs-pdf-list.txt'</span>,header<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">"|"</span>) <span style="color: #408080; font-style: italic;"># read file, choose a delimiter absent from the file</span>
cns_drug_string <span style="color: #666666;">=</span> paste(uhc_cns_drug_list$V1, sep<span style="color: #666666;">=</span><span style="color: #ba2121;">" "</span>, collapse<span style="color: #666666;">=</span><span style="color: #ba2121;">" "</span>) <span style="color: #408080; font-style: italic;"># collapse it into a single huge string</span>
cns_drug_string <span style="color: #666666;">=</span> tolower(cns_drug_string) <span style="color: #408080; font-style: italic;"># convert to lowercase</span>

fda_annotations$cns_drug <span style="color: #666666;">=</span> <span style="color: #008000; font-weight: bold;">FALSE</span> <span style="color: #408080; font-style: italic;"># initialize a column for whether a cns drug or not</span>
<span style="color: #008000; font-weight: bold;">for</span> (i in <span style="color: #666666;">1</span>:dim(fda_annotations)[<span style="color: #666666;">1</span>]) { <span style="color: #408080; font-style: italic;"># loop through b/c grep doesn't support vector operations.</span>
  fda_annotations$cns_drug[i] <span style="color: #666666;">=</span> length(grep(tolower(fda_annotations$TestSubstance_ChemicalName[i]),cns_drug_string)) <span style="color: #666666;">&gt;</span> <span style="color: #666666;">0</span> 
}
which(fda_annotations$cns_drug) <span style="color: #408080; font-style: italic;"># list of indices</span>
fda_annotations$TestSubstance_ChemicalName[fda_annotations$cns_drug] <span style="color: #408080; font-style: italic;"># list of names</span></pre>
</div>
<p>I got 122 hits &#8211; not bad!  A paper I had run across discussed only 74 [<a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1201314/">Pajouhesh &amp; Lenz 2005</a>], so I figured I might be in the right ballpark.  But on spot-checking it, I noticed that <a href="http://en.wikipedia.org/wiki/Aripiprazole">aripiprazole</a> (Abilify) was conspicuously absent &#8211; hey, it&#8217;s only <a href="http://web.archive.org/web/20130917034434/http://www.drugs.com/stats/abilify"><em>the</em> best-selling drug in the United States as of 2013</a>.  On further investigation, it turns out Abilify <em>is</em> covered by <a href="https://www.unitedhealthcareonline.com/ccmcontent/ProviderII/UHC/en-US/Assets/ProviderStaticFiles/ProviderStaticFilesPdf/Tools%20and%20Resources/Pharmacy%20Resources/PDL_Phys_Bk.pdf">UHC (see p. 19)</a>, it&#8217;s just not in the EPA&#8217;s list to begin with.</p>
<p><strong>second try</strong></p>
<p>Obviously I needed a more exhaustive drug list to start with.  At this point I became aware of <a href="http://www.drugbank.ca/">DrugBank</a>, which strives to be exactly the resource I was looking for to begin with.  (Note: although DrugBank is Canadian, according to <a href="http://www.drugbank.ca/about">About</a> its definition of &#8220;Approved&#8221; is FDA-approved). DrugBank is incredibly exhaustive &#8211; so much so that it ends up not being formatted in a user-friendly way.  And even DrugBank does not have any easy machine-readable way of determining whether something is a CNS drug.  So I had two tasks: to distill DrugBank down to a few columns, and to figure out which ones were CNS drugs.</p>
<p>First, I downloaded the &#8220;DrugCard&#8221; formatted version of the DrugBank database and used command line tools to extract the generic name, list of brand names, isomeric SMILES string, &#8220;Drug_Type&#8221; (approved vs. experimental, with some other designations as well) and indication (a free text string I didn&#8217;t end up using):</p>
<pre>wget http://www.drugbank.ca/system/downloads/current/drugbank.txt.zip
unzip drugbank.txt.zip
cat drugbank.txt | grep -A 2 Generic_Name | awk 'NR%4 == 2 {print $0}' &gt; generic_names.txt
cat drugbank.txt | grep -A 4 ^"# Brand_Names" | tr '\n' ',' | sed 's/--/\n/g' | sed 's/# Brand_Names://' | sed 's/(.*//' | sed 's/#.*//' &gt; brand_names.txt
cat drugbank.txt | grep -A 2 ^"# Smiles_String_isomeric" | awk 'NR%4 == 2 {print $0}' | sed 's/Not Available//' &gt; smiles.txt
cat drugbank.txt | grep -A 2 ^"# Drug_Type" | awk 'NR%4 == 2 {print $0}' &gt; first_group.txt
cat drugbank.txt | grep -A 2 ^"# Indication" | awk 'NR%4 == 2 {print $0}' &gt; indications.txt
paste -d '|' generic_names.txt brand_names.txt first_group.txt smiles.txt indications.txt &gt; drugbank.5col.pipe</pre>
<p>A few notes on some command line tricks above.  <code>awk 'NR%4 ==2'</code> processes only the third line (0, 1, <span style="text-decoration: underline;">2</span>, 3) in each 4-line grep hit. <code>paste</code> is like a sideways <code>cat</code>.  In the brand names line, <code>grep -A 4</code> reads 4 lines trailing <span style="text-decoration: underline;">a</span>fter the grep hit, in order to grab up to 4 different brand names.   <code>tr</code> replaces the newlines with commas to comma-separate the ≤ 4 resulting hits (see <a href="http://stackoverflow.com/questions/1251999/sed-how-can-i-replace-a-newline-n">here</a>).  <code>sed 's/--/\n/g'</code> replaces the <code>--</code> which separates each grep hit with a newline, thus restoring one line per drug.  The remaining <code>sed</code> commands just remove extraneous text (see <a href="http://stackoverflow.com/questions/5047165/sed-replacing-from-string-to-end-of-line">here</a>).</p>
<p>With that, I was done with the command line and read the table into R.</p>
<div class="highlight" style="background: #f8f8f8;">
<pre style="line-height: 125%;">drugbank <span style="color: #666666;">=</span> read.table(<span style="color: #ba2121;">'c:/sci/037cinf/data/drugbank.txt/drugbank.5col.pipe'</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">'|'</span>,header<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,quote<span style="color: #666666;">=</span><span style="color: #ba2121;">""</span>,comment.char<span style="color: #666666;">=</span><span style="color: #ba2121;">""</span>)
colnames(drugbank) <span style="color: #666666;">=</span> c(<span style="color: #ba2121;">"generic_name"</span>,<span style="color: #ba2121;">"brand_names"</span>,<span style="color: #ba2121;">"first_group"</span>,<span style="color: #ba2121;">"smiles"</span>,<span style="color: #ba2121;">"indication"</span>)</pre>
</div>
<p>Next I decided I wanted a more exhaustive list of CNS drugs than whatever United Health Care happens to cover. I Googled &#8220;list of central nervous system prescription drugs covered by insurance&#8221; and managed to find five insurance plans that gave exhaustive categorized lists of the drugs they cover, including a &#8220;Central Nervous System agents&#8221; category or similar: <a href="http://www.bcbstx.com/pdf/drug_list.pdf">BCBS Texas</a>, <a href="http://www.caremark.com/portal/asset/caremark_drug_list.pdf">CareMark</a>, <a href="https://www.healthalliance.org/media/HAMP_formulary.pdf%E2%80%8E">Health Alliance</a>, <a href="http://apps.humana.com/marketing/documents.asp?file=2168465">Humana Enhanced</a> (I arbitrarily chose Wisconsin 2014), plus the original <a href="https://www.unitedhealthcareonline.com/ccmcontent/ProviderII/UHC/en-US/Assets/ProviderStaticFiles/ProviderStaticFilesPdf/Tools%20and%20Resources/Pharmacy%20Resources/PDL_Phys_Bk.pdf">United Health Care</a> document (<em>all downloaded on October 4, 2013</em>).  The Humana document is exceptionally comprehensive, with 31 pages (pp 64-94) devoted exclusively to listing CNS drugs in 5 different tiers including &#8220;non-preferred&#8221; drugs.</p>
<p>I copied and pasted the CNS drugs list from each PDF into a text file and collapsed them into one enormous string in R:</p>
<div class="highlight" style="background: #f8f8f8;">
<pre style="line-height: 125%;"><span style="color: #408080; font-style: italic;"># in read.table, choose a delimiter absent from the file such as | in order to just read all as one column.</span>
uhc_cns_drug_list      <span style="color: #666666;">=</span> read.table(<span style="color: #ba2121;">'c:/sci/037cinf/data/uhc-cns-drugs-pdf-list.txt'</span>,header<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">"|"</span>) <span style="color: #408080; font-style: italic;"># # https://www.unitedhealthcareonline.com/ccmcontent/ProviderII/UHC/en-US/Assets/ProviderStaticFiles/ProviderStaticFilesPdf/Tools%20and%20Resources/Pharmacy%20Resources/PDL_Phys_Bk.pdf </span>
humana_cns_drug_list   <span style="color: #666666;">=</span> read.table(<span style="color: #ba2121;">'c:/sci/037cinf/data/humana_2014_wi.txt'</span>,header<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">"|"</span>) <span style="color: #408080; font-style: italic;"># http://apps.humana.com/marketing/documents.asp?file=2168465</span>
ha_cns_drug_list       <span style="color: #666666;">=</span> read.table(<span style="color: #ba2121;">'c:/sci/037cinf/data/healthalliance-2013.txt'</span>,header<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">"|"</span>) <span style="color: #408080; font-style: italic;"># https://www.healthalliance.org/media/HAMP_formulary.pdf%E2%80%8E</span>
bcbst_cns_drug_list    <span style="color: #666666;">=</span> read.table(<span style="color: #ba2121;">'c:/sci/037cinf/data/bcbst-2014.txt'</span>,header<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">"|"</span>) <span style="color: #408080; font-style: italic;"># http://www.bcbstx.com/pdf/drug_list.pdf</span>
caremark_cns_drug_list <span style="color: #666666;">=</span> read.table(<span style="color: #ba2121;">'c:/sci/037cinf/data/caremark-oct2013.txt'</span>,header<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">"|"</span>)  <span style="color: #408080; font-style: italic;"># http://www.caremark.com/portal/asset/caremark_drug_list.pdf</span>
all_cns_drug_lists <span style="color: #666666;">=</span> rbind(uhc_cns_drug_list, humana_cns_drug_list, ha_cns_drug_list, bcbst_cns_drug_list, caremark_cns_drug_list) <span style="color: #408080; font-style: italic;"># concatenate all together</span>
cns_drug_string <span style="color: #666666;">=</span> paste(all_cns_drug_lists$V1, sep<span style="color: #666666;">=</span><span style="color: #ba2121;">" "</span>, collapse<span style="color: #666666;">=</span><span style="color: #ba2121;">" "</span>) <span style="color: #408080; font-style: italic;"># collapse it into a single huge string</span>
cns_drug_string <span style="color: #666666;">=</span> tolower(cns_drug_string) <span style="color: #408080; font-style: italic;"># convert to lowercase</span></pre>
</div>
<p>To check my DrugBank list against the insurance plan coverage lists, I needed a few tricks.  <a href="http://stackoverflow.com/questions/12885257/r-grep-whole-words-separated-by-special-characters"><code>grep</code> with <code>\\b</code> does whole-word matching</a> &#8211; otherwise, &#8220;iron&#8221; matches &#8220;buspirone&#8221;. Non-alphanumeric characters in brand names appeared extraneous, so I removed them with <a href="http://stackoverflow.com/questions/8959243/r-remove-non-alphanumeric-symbols-from-a-string"><code>gsub("[^[:alnum:] ]", "", str)</code></a>. Braces, brackets and parentheses in generic names always seemed to occur in IUPAC chemical names which would never be in the insurance plan list anyway, so I just skipped those.</p>
<div class="highlight" style="background: #f8f8f8;">
<pre style="line-height: 125%;">drugbank$cns_drug <span style="color: #666666;">=</span> <span style="color: #008000; font-weight: bold;">FALSE</span> <span style="color: #408080; font-style: italic;"># initialize a column for whether a cns drug or not</span>
<span style="color: #008000; font-weight: bold;">for</span> (i in <span style="color: #666666;">1</span>:dim(drugbank)[<span style="color: #666666;">1</span>]) { <span style="color: #408080; font-style: italic;"># loop all drugs.  grep doesn't support vector operations.</span>
  <span style="color: #408080; font-style: italic;"># check for generic names</span>
  generic_name_present <span style="color: #666666;">=</span> <span style="color: #008000; font-weight: bold;">FALSE</span> <span style="color: #408080; font-style: italic;"># initialize</span>
  <span style="color: #408080; font-style: italic;"># some generic names are chemical names with []{}() characters which mess up regexes</span>
  <span style="color: #408080; font-style: italic;"># and obviously aren't called by that name in any insurance plans anyway, so skip those</span>
  <span style="color: #008000; font-weight: bold;">if</span>(!length(grep(<span style="color: #ba2121;">"\\}|\\{|\\[|\\]|\\(|\\)"</span>,drugbank$generic_name[i])) <span style="color: #666666;">&gt;</span> <span style="color: #666666;">0</span>) {
    <span style="color: #408080; font-style: italic;"># if grep finds a match between the DrugBank generic name and the cns drug list, set TRUE</span>
    generic_name_present <span style="color: #666666;">=</span> length(grep(paste(<span style="color: #ba2121;">"\\b"</span>,tolower(drugbank$generic_name[i]),<span style="color: #ba2121;">"\\b"</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">""</span>),cns_drug_string)) <span style="color: #666666;">&gt;</span> <span style="color: #666666;">0</span> 
  }
  <span style="color: #408080; font-style: italic;"># check for brand names</span>
  brand_name_present <span style="color: #666666;">=</span> <span style="color: #008000; font-weight: bold;">FALSE</span> <span style="color: #408080; font-style: italic;"># initizalize</span>
  brand_name_vector <span style="color: #666666;">=</span> strsplit(drugbank$brand_names[i],split<span style="color: #666666;">=</span><span style="color: #ba2121;">','</span>)[[<span style="color: #666666;">1</span>]] <span style="color: #408080; font-style: italic;"># split the list of brand names on comma</span>
  <span style="color: #408080; font-style: italic;"># remove empty and "Not Available" entries</span>
  brand_name_vector <span style="color: #666666;">=</span> brand_name_vector[<span style="color: #666666;">-</span>which(brand_name_vector<span style="color: #666666;">==</span><span style="color: #ba2121;">""</span> <span style="color: #666666;">|</span> brand_name_vector<span style="color: #666666;">==</span><span style="color: #ba2121;">"Not Available"</span>)]
  <span style="color: #408080; font-style: italic;"># loop through all brand names</span>
  <span style="color: #008000; font-weight: bold;">for</span> (brand_name in brand_name_vector) { 
    <span style="color: #408080; font-style: italic;"># some brand names in DrugBank are listed with characters like [] that mess up regexes, so:</span>
    brand_name_alphanumeric <span style="color: #666666;">=</span> gsub(<span style="color: #ba2121;">"[^[:alnum:] ]"</span>, <span style="color: #ba2121;">""</span>, brand_name) <span style="color: #408080; font-style: italic;"># remove nonalphanumeric characters</span>
    <span style="color: #408080; font-style: italic;"># now check if it's in the CNS drug list string</span>
    <span style="color: #008000; font-weight: bold;">if</span> (length(grep(paste(<span style="color: #ba2121;">"\\b"</span>,tolower(brand_name_alphanumeric),<span style="color: #ba2121;">"\\b"</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">""</span>),cns_drug_string)) <span style="color: #666666;">&gt;</span> <span style="color: #666666;">0</span>) {
      brand_name_present <span style="color: #666666;">=</span> <span style="color: #008000; font-weight: bold;">TRUE</span>
    }
  }
  <span style="color: #408080; font-style: italic;"># either a generic or brand name hit counts for setting cns_drug to TRUE</span>
  drugbank$cns_drug[i] <span style="color: #666666;">=</span> generic_name_present <span style="color: #666666;">|</span> brand_name_present
}

which(drugbank$cns_drug) <span style="color: #408080; font-style: italic;"># list of indices</span>
drugbank$generic_name[drugbank$cns_drug <span style="color: #666666;">&amp;</span> drugbank$first_group <span style="color: #666666;">==</span> <span style="color: #ba2121;">'Approved'</span>] <span style="color: #408080; font-style: italic;"># list of names</span></pre>
</div>
<p>Casting a wider net for insurance plans paid off &#8211; I got 221 FDA-approved CNS drugs when grepping against all five insurance plans, compared to 155 with only UHC. And of course, the more exhaustive DrugBank list paid off too &#8211; aripiprazole is on the new list, and I&#8217;ve got vastly more than the original 122 hits.</p>
<p>I certainly can&#8217;t make any guarantees about this new list.  I think it&#8217;s at least pretty decent because with a bit of spot-checking I haven&#8217;t yet been able to think of a CNS drug I know of that isn&#8217;t on the list, nor have I been able to find an item on the list that isn&#8217;t a CNS drug.</p>
<p>I wrote the lists out to files:</p>
<div class="highlight" style="background: #f8f8f8;">
<pre style="line-height: 125%;">drug_list <span style="color: #666666;">=</span> drugbank[drugbank$first_group <span style="color: #666666;">==</span> <span style="color: #ba2121;">'Approved'</span>, c(<span style="color: #ba2121;">'generic_name'</span>,<span style="color: #ba2121;">'cns_drug'</span>,<span style="color: #ba2121;">'smiles'</span>)]
drug_list_ordered <span style="color: #666666;">=</span> drug_list[with(drug_list,order(generic_name)),]
dim(drug_list_ordered) <span style="color: #408080; font-style: italic;"># 1691 3</span>
write.table(drug_list_ordered,<span style="color: #ba2121;">'drugs.txt'</span>,sep<span style="color: #666666;">=</span><span style="color: #ba2121;">'\t'</span>,row.names<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,col.names<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">TRUE</span>,quote<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>)

cns_list <span style="color: #666666;">=</span> sort(drugbank$generic_name[drugbank$cns_drug <span style="color: #666666;">&amp;</span> drugbank$first_group<span style="color: #666666;">==</span><span style="color: #ba2121;">'Approved'</span>])
write.table(cns_list,<span style="color: #ba2121;">'cnsdrugs.txt'</span>,row.names<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,col.names<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>,quote<span style="color: #666666;">=</span><span style="color: #008000; font-weight: bold;">FALSE</span>)</pre>
</div>
<p>And then uploaded to this blog post.  Here they are again: <a href="/wp-content/uploads/2013/10/drugs.txt">drugs.txt</a> <a href="/wp-content/uploads/2013/10/cnsdrugs.txt">cnsdrugs.txt</a></p>
